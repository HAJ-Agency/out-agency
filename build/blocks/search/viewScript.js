(()=>{var e;(e=jQuery)(function(){let s=[],t=0;e(".search-header").each(function(){const o=e(this),n=o.find(".search-content-container"),i=o.find(".search-input"),r=o.find(".search-results-list"),h=o.find(".search-results-container"),a=o.find(".search-results-container-overlay"),c=o.find(".search-results-show-more .wp-block-button"),l=o.find(".search-results-loading"),d=o.find(".search-results-empty"),u=o.find(".search-results-showing"),p=o.find(".search-results-count"),m=e(".search-results-show-more-loader"),f=e(".search-results-show-more-text");let v;o.find(".search-open-button").on("click",function(){n.hasClass("open")?(n.removeClass("open"),h.removeClass("open").css("top","100%"),setTimeout(()=>{n.css("visibility","hidden"),console.log("Search container hidden")},200)):(n.css("visibility","visible"),n.addClass("open"),i.trigger("focus"),setTimeout(()=>{h.css("top",`calc(var(--header-height) + ${n.outerHeight()}px)`)},200)),i.val("")}),o.find(".search-close-button").on("click",function(){n.removeClass("open"),h.removeClass("open"),h.removeClass("open").css("top","100%"),i.val(""),setTimeout(()=>n.css("visibility","hidden"),200)}),e(document).on("click",function(s){e(s.target).closest(".search-header").length||(n.removeClass("open"),h.removeClass("open"),h.css("top","100%"),i.val(""),setTimeout(()=>n.css("visibility","hidden"),200))});const g=(t,o,n=!0)=>e.ajax({url:"/wp-json/hapi/v1/search-page/",method:"GET",data:{search_value:t,offset:o,posts_per_page:8},success:function(e){const t=e.posts||[],o=e.found_posts||0;return c.toggle(!!e.has_more),n?w(t,o,!0):s.push(...t),e}}),w=(s,t,n=!1)=>{n?(r.empty(),p.text(t),u.text(s.length)):u.text(r.find(".search-result-item").length+s.length),s.length>0?(d.hide(),s.forEach(s=>{const t=e(".search-result-template").clone().removeClass("search-result-template").addClass("search-result-item");t.find(".search-result-title").text(s.title),t.find(".search-result-excerpt").html(s.excerpt),t.find(".search-result-image").html(s.image),t.find(".search-result-link").attr("href",s.link),r.append(t)})):d.show(),r.show(),l.hide(),o.find(".search-results-show-more").show()};i.on("input",function(){h.css("top",`calc(var(--header-height) + ${n.outerHeight()}px)`),a.css("max-height",`calc(100vh - var(--header-height) - ${n.outerHeight()}px)`),r.hide(),l.show(),o.find(".search-results-show-more").hide(),clearTimeout(v),v=setTimeout(()=>{const e=i.val().trim();e.length>0?(t=0,s=[],h.addClass("open"),g(e,0).then(()=>{t+=8,m.show(),f.hide(),g(e,t,!1).then(()=>{m.hide(),f.show()})})):(r.empty(),h.removeClass("open"))},200)}),c.on("click",function(){const e=i.val().trim();if(s.length>0){m.show(),f.hide();const o=s.splice(0,8);w(o,!0),t+=8,g(e,t,!1).then(()=>{m.hide(),f.show()})}})})})})();