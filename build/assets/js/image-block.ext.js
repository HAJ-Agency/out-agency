(()=>{"use strict";const e=window.ReactJSXRuntime,{addFilter:t}=wp.hooks,{createHigherOrderComponent:o}=wp.compose,{InspectorControls:r,useBlockProps:a}=wp.blockEditor,{PanelRow:i,PanelBody:s,ToggleControl:l,CustomSelectControl:n,RadioControl:d,TextControl:c,RangeControl:m}=wp.components,{Fragment:p,useRef:h}=wp.element,{__}=wp.i18n;t("blocks.registerBlockType","extend-cover-block/add-extra-attributes",(e,t)=>("core/image"===t&&(e.attributes={...e.attributes,watermark:{type:"boolean",default:!1},watermarkPosition:{type:"object",default:{x:"0",y:"0"}},watermarkOpacity:{type:"number",default:1},isHideOnMobile:{type:"boolean",default:!1},isHideOnDesktop:{type:"boolean",default:!1}}),e)),t("editor.BlockEdit","extend-core-image/with-extra-controls",o(t=>o=>{const{attributes:a,setAttributes:n,name:d}=o;if("core/image"===d){const{watermark:d,watermarkPosition:c,watermarkOpacity:x,isHideOnMobile:k,isHideOnDesktop:w}=a,b=({value:t,onChange:o})=>{const r=h(null);return(0,e.jsx)("div",{ref:r,style:{position:"relative",width:"100%",height:"150px",background:"#f0f0f0",border:"1px solid #ccc",borderRadius:"4px",cursor:"crosshair",userSelect:"none",boxSizing:"border-box"},onClick:e=>{const t=r.current.getBoundingClientRect(),a=e.clientX-t.left,i=e.clientY-t.top,s=Math.round(a/t.width*200-100),l=Math.round(i/t.height*200-100);o({x:Math.max(-100,Math.min(100,s)),y:Math.max(-100,Math.min(100,l))})},children:(0,e.jsx)("div",{style:{position:"absolute",top:75+75*t.y/100+"px",left:50+50*t.x/100+"%",width:"10px",height:"10px",background:"#D6EBFF",border:"1px solid #002A3A",borderRadius:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"}})})},u=e=>{n({watermarkPosition:e})};return(0,e.jsxs)(p,{children:[(0,e.jsx)(t,{...o}),(0,e.jsxs)(r,{children:[(0,e.jsxs)(s,{title:__("Vattenstämpel","trelleborg"),children:[(0,e.jsx)(i,{children:(0,e.jsx)("div",{className:"full-width-control",children:(0,e.jsx)(l,{label:__("Använd som vattenstämpel","trelleborg"),checked:d,onChange:e=>{n({watermark:e})}})})}),d&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(i,{children:(0,e.jsx)(b,{value:c,onChange:u})}),(0,e.jsx)(i,{children:(0,e.jsx)("div",{className:"full-width-control",children:(0,e.jsx)(m,{label:__("Opacitet","trelleborg"),value:x,onChange:e=>n({watermarkOpacity:e}),min:0,max:1,step:.005})})})]})]}),(0,e.jsxs)(s,{title:__("Dölj på olika skärmstorlekar","trelleborg"),children:[(0,e.jsx)(i,{children:(0,e.jsx)("div",{className:"full-width-control",children:(0,e.jsx)(l,{label:__("Dölj på Mobil","trelleborg"),checked:k,onChange:e=>{n({isHideOnMobile:e})}})})}),(0,e.jsx)(i,{children:(0,e.jsx)("div",{className:"full-width-control",children:(0,e.jsx)(l,{label:__("Dölj på Desktop","trelleborg"),checked:w,onChange:e=>{n({isHideOnDesktop:e})}})})})]})]})]})}return(0,e.jsx)(t,{...o})},"withExtraControls")),wp.hooks.addFilter("blocks.getSaveContent.extraProps","extend-core-image/apply-styles",(e,t,o)=>{if("core/image"===t.name){const{watermark:t,watermarkPosition:r,watermarkOpacity:a,isHideOnMobile:i,isHideOnDesktop:s}=o;t&&(e.style={...e.style,"--watermark-position-x":`${r.x}`,"--watermark-position-y":`${r.y}`,"--watermark-opacity":void 0!==a?`${a}`:1},e.className=[e.className||"","image-is-watermark"].filter(Boolean).join(" ")),i&&(e.className=[e.className||"","is-mobile-hidden"].filter(Boolean).join(" ")),s&&(e.className=[e.className||"","is-desktop-hidden"].filter(Boolean).join(" "))}return e});const x=o(t=>o=>{const{name:r,attributes:a}=o;if("core/image"===r){const{watermark:r,watermarkPosition:i,watermarkOpacity:s,isHideOnMobile:l,isHideOnDesktop:n}=a;let d={};return r&&(d["data-is-watermark"]="true",d.style={...d.style,"--watermark-position-x":`${i.x}`,"--watermark-position-y":`${i.y}`,"--watermark-opacity":void 0!==s?`${s}`:1}),l&&(d.className=[d.className||"","is-mobile-hidden"].filter(Boolean).join(" ")),n&&(d.className=[d.className||"","is-desktop-hidden"].filter(Boolean).join(" ")),(0,e.jsx)(t,{...o,wrapperProps:d})}return(0,e.jsx)(t,{...o})},"addPropsToEditor");wp.hooks.addFilter("editor.BlockListBlock","extend-core-image/apply-styles-editor",x)})();